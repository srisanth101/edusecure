<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EduXpress</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        :root {
            --primary: #0d47a1;
            --primary-light: #5472d3;
            --primary-dark: #002171;
            --secondary: #546e7a;
            --accent: #82b1ff;
            --success: #00c853;
            --warning: #ffab00;
            --danger: #ff1744;
            --background: #121212;
            --card-bg: #1e1e1e;
            --text: #e0e0e0;
            --text-muted: #9e9e9e;
            --border: #424242;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.5), 0 0 10px rgba(66, 133, 244, 0.3);
            --radius: 12px;
            --radius-full: 50%;
            --glow: 0 0 10px rgba(66, 133, 244, 0.7);
        }

        [data-theme="light"] {
            --primary: #0d47a1;
            --primary-light: #5472d3;
            --primary-dark: #002171;
            --secondary: #546e7a;
            --accent: #82b1ff;
            --success: #00c853;
            --warning: #ffab00;
            --danger: #ff1744;
            --background: #f5f5f5;
            --card-bg: #ffffff;
            --text: #212121;
            --text-muted: #757575;
            --border: #e0e0e0;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.1), 0 0 10px rgba(66, 133, 244, 0.2);
            --glow: 0 0 10px rgba(66, 133, 244, 0.5);
        }

        body {
            background: var(--background);
            color: var(--text);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            width: 100%;
        }

        /* Login Page Styles */
        .login-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
            text-align: center;
        }

        .login-logo {
            width: 120px;
            height: 120px;
            border-radius: var(--radius-full);
            margin: 0 auto 30px;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow);
            overflow: hidden;
            border: 3px solid var(--accent);
        }

        .login-logo img {
            width: 80%;
            height: 80%;
            border-radius: var(--radius-full);
            object-fit: cover;
        }

        .login-title {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(90deg, var(--primary-light), var(--accent));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: var(--glow);
        }

        .login-subtitle {
            font-size: 18px;
            color: var(--text-muted);
            margin-bottom: 50px;
        }

        .login-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
            width: 100%;
            max-width: 700px;
        }

        .login-option {
            background: var(--card-bg);
            border-radius: var(--radius);
            padding: 40px 30px;
            text-align: center;
            box-shadow: var(--shadow);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
            border: 1px solid var(--border);
        }

        .login-option:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3), var(--glow);
            border-color: var(--primary-light);
        }

        .login-icon {
            width: 80px;
            height: 80px;
            border-radius: var(--radius);
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            color: white;
        }

        .login-option h2 {
            font-size: 24px;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .login-option p {
            color: var(--text-muted);
            font-size: 16px;
            line-height: 1.5;
        }

        /* Onboarding Styles */
        .onboarding {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
            text-align: center;
        }

        .onboarding-step {
            display: none;
            max-width: 600px;
            width: 100%;
            animation: fadeIn 0.5s ease;
        }

        .onboarding-step.active {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .onboarding-image {
            width: 300px;
            height: 300px;
            border-radius: var(--radius);
            margin-bottom: 30px;
            overflow: hidden;
            box-shadow: var(--shadow);
            border: 3px solid var(--primary-light);
        }

        .onboarding-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .onboarding-content {
            margin-bottom: 30px;
        }

        .onboarding-content h2 {
            font-size: 28px;
            margin-bottom: 15px;
            color: var(--primary);
        }

        .typing-text {
            font-size: 18px;
            color: var(--text-muted);
            line-height: 1.6;
            min-height: 60px;
            margin-bottom: 20px;
        }

        .typing-cursor {
            display: inline-block;
            width: 3px;
            height: 1em;
            background-color: var(--primary);
            margin-left: 2px;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }

        .onboarding-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .btn {
            padding: 12px 24px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: var(--shadow);
        }

        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3), var(--glow);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: var(--secondary);
        }

        .btn-secondary:hover {
            background: #455a64;
        }

        .btn-success {
            background: var(--success);
        }

        .btn-success:hover {
            background: #00b248;
        }

        .theme-selection {
            display: flex;
            gap: 20px;
            margin-top: 20px;
        }

        .theme-option {
            padding: 20px;
            background: var(--card-bg);
            border-radius: var(--radius);
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid var(--border);
            text-align: center;
            flex: 1;
            box-shadow: var(--shadow);
        }

        .theme-option:hover {
            transform: translateY(-5px);
            border-color: var(--primary-light);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3), var(--glow);
        }

        .theme-option.selected {
            border-color: var(--primary);
            background: var(--primary);
            color: white;
        }

        .theme-icon {
            font-size: 40px;
            margin-bottom: 10px;
        }

        /* Portal Styles */
        .portal-container {
            display: none;
        }

        .portal-container.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        header {
            text-align: center;
            padding: 30px 0;
            position: relative;
        }

        .theme-switch {
            position: absolute;
            top: 20px;
            right: 20px;
        }

        .theme-toggle {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 8px 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text);
            font-weight: 500;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            transform: translateY(-2px);
        }

        .logo {
            width: 100px;
            height: 100px;
            border-radius: var(--radius-full);
            margin: 0 auto 20px;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow);
            overflow: hidden;
            border: 3px solid var(--accent);
        }

        .logo img {
            width: 80%;
            height: 80%;
            border-radius: var(--radius-full);
            object-fit: cover;
        }

        h1 {
            font-size: 34px;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(90deg, var(--primary-light), var(--accent));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .subtitle {
            font-size: 17px;
            color: var(--text-muted);
            margin-bottom: 40px;
        }

        .portal-selection {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .portal-card {
            background: var(--card-bg);
            border-radius: var(--radius);
            padding: 30px;
            text-align: center;
            box-shadow: var(--shadow);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
            border: 1px solid var(--border);
        }

        .portal-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
            border-color: var(--primary-light);
        }

        .portal-icon {
            width: 80px;
            height: 80px;
            border-radius: var(--radius);
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            color: white;
        }

        .login-form {
            background: var(--card-bg);
            border-radius: var(--radius);
            padding: 30px;
            box-shadow: var(--shadow);
            max-width: 500px;
            margin: 0 auto;
            display: none;
            border: 1px solid var(--border);
        }

        .login-form.active {
            display: block;
            animation: fadeIn 0.4s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            font-size: 17px;
        }

        .form-control {
            width: 100%;
            padding: 16px;
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 10px;
            color: var(--text);
            font-size: 17px;
            transition: all 0.2s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-light);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
        }

        .btn-block {
            width: 100%;
        }

        .back-btn {
            margin-top: 15px;
        }

        .dashboard {
            display: none;
        }

        .dashboard.active {
            display: block;
            animation: fadeIn 0.4s ease;
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px;
            background: var(--card-bg);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-avatar {
            width: 60px;
            height: 60px;
            border-radius: var(--radius-full);
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            color: white;
            overflow: hidden;
        }

        .user-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .user-details h3 {
            font-size: 22px;
            margin-bottom: 5px;
        }

        .user-details p {
            color: var(--text-muted);
            font-size: 16px;
        }

        .tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 25px;
            background: var(--card-bg);
            padding: 8px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
        }

        .tab {
            flex: 1;
            padding: 14px;
            background: transparent;
            border: none;
            color: var(--text-muted);
            font-size: 17px;
            font-weight: 500;
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.2s ease;
        }

        .tab.active {
            background: var(--primary);
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.4s ease;
        }

        .card {
            background: var(--card-bg);
            border-radius: var(--radius);
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border);
        }

        .card-title {
            font-size: 20px;
            font-weight: 600;
        }

        .student-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }

        .student-card {
            background: var(--card-bg);
            border-radius: var(--radius);
            padding: 20px;
            text-align: center;
            transition: transform 0.2s ease;
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
            position: relative;
        }

        .student-card:hover {
            transform: translateY(-3px);
            border-color: var(--primary-light);
        }

        .student-img {
            width: 80px;
            height: 80px;
            border-radius: var(--radius-full);
            margin: 0 auto 15px;
            background: var(--secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            color: white;
            overflow: hidden;
            border: 2px solid var(--primary-light);
        }

        .student-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .face-scan-container {
            text-align: center;
            padding: 40px 20px;
        }

        .camera-container {
            width: 300px;
            height: 300px;
            margin: 0 auto 30px;
            border-radius: var(--radius);
            overflow: hidden;
            position: relative;
            border: 3px solid var(--primary-light);
            box-shadow: var(--shadow);
        }

        #cameraVideo {
            width: 100%;
            height: 100%;
            object-fit: cover;
            background: #000;
        }

        #cameraCanvas {
            display: none;
        }

        .scan-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            font-size: 18px;
            z-index: 10;
        }

        .scanning-text {
            font-size: 18px;
            margin-bottom: 20px;
            color: var(--text-muted);
        }

        .homework-item, .message-item {
            padding: 20px;
            background: var(--card-bg);
            border-radius: var(--radius);
            margin-bottom: 15px;
            border-left: 4px solid var(--primary-light);
            border: 1px solid var(--border);
        }

        .homework-item h4, .message-item h4 {
            margin-bottom: 10px;
            color: var(--primary-light);
            font-size: 18px;
        }

        .homework-meta, .message-meta {
            display: flex;
            justify-content: space-between;
            color: var(--text-muted);
            font-size: 15px;
            margin-top: 12px;
        }

        .footer {
            text-align: center;
            padding: 30px;
            margin-top: 40px;
            color: var(--text-muted);
            font-size: 15px;
            border-top: 1px solid var(--border);
        }

        /* Progress indicator */
        .progress-indicator {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 30px;
        }

        .progress-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--border);
            transition: all 0.3s ease;
        }

        .progress-dot.active {
            background: var(--primary);
            transform: scale(1.2);
        }

        /* Subject Selection Styles */
        .subject-selection {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .subject-selection.active {
            display: block;
        }

        .back-to-dashboard {
            margin-bottom: 20px;
        }

        .class-selection {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 30px;
        }

        .class-btn {
            padding: 12px 20px;
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 10px;
            color: var(--text);
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            flex: 1;
            min-width: 120px;
            text-align: center;
        }

        .class-btn:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
        }

        .class-btn.active {
            background: var(--primary);
            color: white;
        }

        .subjects-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }

        .subject-card {
            background: var(--card-bg);
            border-radius: var(--radius);
            padding: 20px;
            text-align: center;
            box-shadow: var(--shadow);
            transition: transform 0.2s ease;
            border: 1px solid var(--border);
            cursor: pointer;
        }

        .subject-card:hover {
            transform: translateY(-3px);
            border-color: var(--primary-light);
        }

        .subject-icon {
            width: 60px;
            height: 60px;
            border-radius: var(--radius);
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
        }

        .subject-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .subject-content.active {
            display: block;
        }

        .ncert-btn, .solution-btn {
            width: 100%;
            margin-bottom: 10px;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .onboarding-image {
                width: 250px;
                height: 250px;
            }
            
            .portal-selection, .login-options {
                grid-template-columns: 1fr;
            }
            
            .theme-selection {
                flex-direction: column;
            }
            
            .onboarding-buttons {
                flex-direction: column;
            }
            
            .dashboard-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .tabs {
                overflow-x: auto;
                padding-bottom: 5px;
            }
            
            .tab {
                white-space: nowrap;
            }
            
            .student-grid {
                grid-template-columns: 1fr;
            }
            
            .camera-container {
                width: 250px;
                height: 250px;
            }
            
            .class-selection {
                flex-direction: column;
            }
            
            .subjects-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Login Page -->
    <div class="login-page" id="loginPage">
        <div class="login-logo">
            <img src="https://blogger.googleusercontent.com/img/a/AVvXsEhpFhqD5C89uDm3t67YDcKkEy8uj-5szXTLnZn05dr99uENL5cZtVS4M8sffWMvauKsZrvuNNSbxKAHWGCMNbR2gwFW-r4vigAamrJ2N0IE_VmANAncYqbj73Q_ScAWzGJ9T7FLz6BBQp9zkT0JOxFlsTgtunnpdlO2fvWzfyxivTGK3efe5kPBraHmZu4" alt="KV Malkapuram Logo">
        </div>
        <h1 class="login-title">EduXpress</h1>
        <p class="login-subtitle">Connect, Learn, and Grow Together</p>
        
        <div class="login-options">
            <div class="login-option" id="teacherLoginOption">
                <div class="login-icon">
                    <i class="fas fa-chalkboard-teacher"></i>
                </div>
                <h2>Teacher Portal</h2>
                <p>Manage students, assign homework, and send important messages</p>
            </div>
            <div class="login-option" id="studentLoginOption">
                <div class="login-icon">
                    <i class="fas fa-user-graduate"></i>
                </div>
                <h2>Student Portal</h2>
                <p>Access your homework, messages, and learning resources</p>
            </div>
        </div>
    </div>

    <!-- Onboarding Steps -->
    <div class="onboarding" id="onboarding">
        <!-- Step 1: Welcome -->
        <div class="onboarding-step active" id="step1">
            <div class="onboarding-image">
                <img src="https://blogger.googleusercontent.com/img/a/AVvXsEhpFhqD5C89uDm3t67YDcKkEy8uj-5szXTLnZn05dr99uENL5cZtVS4M8sffWMvauKsZrvuNNSbxKAHWGCMNbR2gwFW-r4vigAamrJ2N0IE_VmANAncYqbj73Q_ScAWzGJ9T7FLz6BBQp9zkT0JOxFlsTgtunnpdlO2fvWzfyxivTGK3efe5kPBraHmZu4" alt="Welcome to KV Malkapuram">
            </div>
            <div class="onboarding-content">
                <h2>Welcome to EduXpress</h2>
                <div class="typing-text" id="typingText1"></div>
            </div>
            <div class="onboarding-buttons">
                <button class="btn" id="nextStep1">Next</button>
            </div>
            <div class="progress-indicator">
                <div class="progress-dot active"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
            </div>
        </div>

        <!-- Step 2: Create Profile -->
        <div class="onboarding-step" id="step2">
            <div class="onboarding-image">
                <img src="https://images.unsplash.com/photo-1531482615713-2afd69097998?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80" alt="Create Profile">
            </div>
            <div class="onboarding-content">
                <h2>Create Your Profile</h2>
                <div class="typing-text" id="typingText2"></div>
            </div>
            <div class="onboarding-buttons">
                <button class="btn btn-secondary" id="prevStep2">Previous</button>
                <button class="btn" id="nextStep2">Next</button>
            </div>
            <div class="progress-indicator">
                <div class="progress-dot"></div>
                <div class="progress-dot active"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
            </div>
        </div>

        <!-- Step 3: KVMLK -->
        <div class="onboarding-step" id="step3">
            <div class="onboarding-image">
                <img src="https://images.unsplash.com/photo-1523240795612-9a054b0db644?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80" alt="KVMLK">
            </div>
            <div class="onboarding-content">
                <h2>KVMLK - Our Identity</h2>
                <div class="typing-text" id="typingText3"></div>
            </div>
            <div class="onboarding-buttons">
                <button class="btn btn-secondary" id="prevStep3">Previous</button>
                <button class="btn" id="nextStep3">Next</button>
            </div>
            <div class="progress-indicator">
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot active"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
            </div>
        </div>

        <!-- Step 4: Features -->
        <div class="onboarding-step" id="step4">
            <div class="onboarding-image">
                <img src="https://images.unsplash.com/photo-1541336032412-2048a678540d?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1074&q=80" alt="Features">
            </div>
            <div class="onboarding-content">
                <h2>Explore Features</h2>
                <div class="typing-text" id="typingText4"></div>
            </div>
            <div class="onboarding-buttons">
                <button class="btn btn-secondary" id="prevStep4">Previous</button>
                <button class="btn" id="nextStep4">Next</button>
            </div>
            <div class="progress-indicator">
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot active"></div>
                <div class="progress-dot"></div>
            </div>
        </div>

        <!-- Step 5: Theme Selection -->
        <div class="onboarding-step" id="step5">
            <div class="onboarding-image">
                <img src="https://images.unsplash.com/photo-1558655146-d09347e92766?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1064&q=80" alt="Choose Theme">
            </div>
            <div class="onboarding-content">
                <h2>Choose Your Theme</h2>
                <div class="typing-text" id="typingText5"></div>
                
                <div class="theme-selection">
                    <div class="theme-option" data-theme="light">
                        <div class="theme-icon">
                            <i class="fas fa-sun"></i>
                        </div>
                        <h3>Light Mode</h3>
                        <p>Clean and bright interface</p>
                    </div>
                    <div class="theme-option" data-theme="dark">
                        <div class="theme-icon">
                            <i class="fas fa-moon"></i>
                        </div>
                        <h3>Dark Mode</h3>
                        <p>Easy on the eyes</p>
                    </div>
                </div>
            </div>
            <div class="onboarding-buttons">
                <button class="btn btn-secondary" id="prevStep5">Previous</button>
                <button class="btn btn-success" id="completeOnboarding">Get Started</button>
            </div>
            <div class="progress-indicator">
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot"></div>
                <div class="progress-dot active"></div>
            </div>
        </div>
    </div>

    <!-- Main Portal -->
    <div class="portal-container" id="portalContainer">
        <div class="container">
            <header>
                <div class="theme-switch">
                    <button class="theme-toggle" id="themeToggle">
                        <i class="fas fa-moon"></i>
                    </button>
                </div>
                <div class="logo">
                    <img src="https://blogger.googleusercontent.com/img/a/AVvXsEhpFhqD5C89uDm3t67YDcKkEy8uj-5szXTLnZn05dr99uENL5cZtVS4M8sffWMvauKsZrvuNNSbxKAHWGCMNbR2gwFW-r4vigAamrJ2N0IE_VmANAncYqbj73Q_ScAWzGJ9T7FLz6BBQp9zkT0JOxFlsTgtunnpdlO2fvWzfyxivTGK3efe5kPBraHmZu4" alt="KV Malkapuram Logo">
                </div>
                <h1>EduXpress</h1>
                <p class="subtitle">Connect, Learn, and Grow Together</p>
            </header>

            <!-- Teacher Login -->
            <div class="login-form" id="teacherLogin">
                <h2 style="margin-bottom: 20px; text-align: center;">Teacher Login</h2>
                <div class="form-group">
                    <label for="teacherSection">Select Section</label>
                    <select id="teacherSection" class="form-control">
                        <option value="">-- Select Section --</option>
                        <option value="primary">Primary</option>
                        <option value="secondary">Secondary</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="teacherSelect">Select Teacher</label>
                    <select id="teacherSelect" class="form-control">
                        <option value="">-- Select Teacher --</option>
                        <!-- Teachers will be populated dynamically -->
                    </select>
                </div>
                <div class="form-group">
                    <label for="teacherPassword">Password</label>
                    <input type="password" id="teacherPassword" class="form-control" placeholder="Enter password">
                </div>
                <button class="btn btn-block" id="teacherLoginBtn">Login</button>
                <button class="btn btn-secondary btn-block back-btn" id="backFromTeacherLogin">Back</button>
            </div>

            <!-- Student Login -->
            <div class="login-form" id="studentLogin">
                <h2 style="margin-bottom: 20px; text-align: center;">Student Login</h2>
                <div class="face-scan-container">
                    <div class="camera-container">
                        <video id="cameraVideo" autoplay playsinline></video>
                        <canvas id="cameraCanvas" width="300" height="300"></canvas>
                        <div class="scan-overlay" id="scanOverlay">
                            <div>
                                <i class="fas fa-camera" style="font-size: 40px; margin-bottom: 10px;"></i>
                                <p>Camera access required</p>
                            </div>
                        </div>
                    </div>
                    <p class="scanning-text" id="scanStatus">Allow camera access to continue with face verification</p>
                    <button class="btn" id="startScanBtn">Start Face Scan</button>
                    <button class="btn btn-success" id="captureBtn" style="display: none;">Capture & Verify</button>
                </div>
                <button class="btn btn-secondary btn-block back-btn" id="backFromStudentLogin">Back</button>
            </div>

            <!-- Teacher Dashboard -->
            <div class="dashboard" id="teacherDashboard">
                <div class="dashboard-header">
                    <div class="user-info">
                        <div class="user-avatar">
                            <img src="https://blogger.googleusercontent.com/img/a/AVvXsEiJY7J3N211LgvtEmXBQYBTrhyV4Msf-rXEkPr6Ns-BxAbOp-2rLh-V4MhUOj9pL0lhHjPbIbdYm7IxB3_wXggfa6hLq8iYu0e3NC9NThaTn61zBVjbFUgF3VPlYmS9BxqmolSzAQW1DYmUea5EiquLqysBntxklO7OQ6uBeZvCLLEkjaKnGaW7FMPakj0" alt="Teacher Avatar" id="teacherAvatar">
                        </div>
                        <div class="user-details">
                            <h3 id="teacherName">Teacher Name</h3>
                            <p id="teacherDetails">Kendriya Vidyalaya Malkapuram</p>
                        </div>
                    </div>
                    <button class="btn" id="teacherLogoutBtn">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>

                <div class="tabs">
                    <button class="tab active" data-tab="students">Students</button>
                    <button class="tab" data-tab="homework">Homework</button>
                    <button class="tab" data-tab="messages">Messages</button>
                </div>

                <div class="tab-content active" id="studentsTab">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Add Student Profile</h3>
                        </div>
                        <div class="form-group">
                            <label for="studentImage">Student Image (Required for Face Recognition)</label>
                            <input type="file" id="studentImage" class="form-control" accept="image/*">
                        </div>
                        <div class="form-group">
                            <label for="studentName">Full Name</label>
                            <input type="text" id="studentName" class="form-control" placeholder="Enter student full name">
                        </div>
                        <div class="form-group">
                            <label for="studentClass">Class</label>
                            <select id="studentClass" class="form-control">
                                <option value="">-- Select Class --</option>
                                <option value="1">Class 1</option>
                                <option value="2">Class 2</option>
                                <option value="3">Class 3</option>
                                <option value="4">Class 4</option>
                                <option value="5">Class 5</option>
                                <option value="6">Class 6</option>
                                <option value="7">Class 7</option>
                                <option value="8">Class 8</option>
                                <option value="9">Class 9</option>
                                <option value="10">Class 10</option>
                                <option value="11A">Class 11A</option>
                                <option value="11B">Class 11B</option>
                                <option value="11C">Class 11C</option>
                                <option value="12A">Class 12A</option>
                                <option value="12B">Class 12B</option>
                                <option value="12C">Class 12C</option>
                            </select>
                        </div>
                        <div class="form-group" id="streamSelection" style="display: none;">
                            <label for="studentStream">Select Stream</label>
                            <select id="studentStream" class="form-control">
                                <option value="">-- Select Stream --</option>
                                <option value="MPC">MPC</option>
                                <option value="BIPC">BIPC</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="studentDob">Date of Birth</label>
                            <input type="date" id="studentDob" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="studentAdmissionNo">Admission Number</label>
                            <input type="text" id="studentAdmissionNo" class="form-control" placeholder="Enter admission number">
                        </div>
                        <div class="form-group">
                            <label for="studentRollNo">Roll Number</label>
                            <input type="number" id="studentRollNo" class="form-control" placeholder="Enter roll number">
                        </div>
                        <button class="btn btn-block" id="addStudentBtn">
                            <i class="fas fa-plus"></i> Add Student
                        </button>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Student Profiles</h3>
                        </div>
                        <div class="student-grid" id="studentList">
                            <!-- Student cards will be dynamically added here -->
                        </div>
                    </div>
                </div>

                <div class="tab-content" id="homeworkTab">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Assign Homework</h3>
                        </div>
                        <div class="form-group">
                            <label for="homeworkTitle">Homework Title</label>
                            <input type="text" id="homeworkTitle" class="form-control" placeholder="Enter homework title">
                        </div>
                        <div class="form-group">
                            <label for="homeworkDescription">Description</label>
                            <textarea id="homeworkDescription" class="form-control" rows="4" placeholder="Enter homework details"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="homeworkDueDate">Due Date</label>
                            <input type="date" id="homeworkDueDate" class="form-control">
                        </div>
                        <button class="btn btn-block" id="assignHomeworkBtn">Assign Homework</button>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Recent Homework</h3>
                        </div>
                        <div id="homeworkList">
                            <!-- Homework items will be dynamically added here -->
                        </div>
                    </div>
                </div>

                <div class="tab-content" id="messagesTab">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Send Message</h3>
                        </div>
                        <div class="form-group">
                            <label for="messageTitle">Message Title</label>
                            <input type="text" id="messageTitle" class="form-control" placeholder="Enter message title">
                        </div>
                        <div class="form-group">
                            <label for="messageContent">Message Content</label>
                            <textarea id="messageContent" class="form-control" rows="4" placeholder="Enter your message"></textarea>
                        </div>
                        <button class="btn btn-block" id="sendMessageBtn">Send Message</button>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Recent Messages</h3>
                        </div>
                        <div id="messageList">
                            <!-- Message items will be dynamically added here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Student Dashboard -->
            <div class="dashboard" id="studentDashboard">
                <div class="dashboard-header">
                    <div class="user-info">
                        <div class="user-avatar">
                            <img src="" alt="Student Avatar" id="studentAvatar">
                        </div>
                        <div class="user-details">
                            <h3 id="studentName">Student Name</h3>
                            <p id="studentDetails">Class | Roll No</p>
                        </div>
                    </div>
                    <button class="btn" id="studentLogoutBtn">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>

                <div class="tabs">
                    <button class="tab active" data-tab="profile">My Profile</button>
                    <button class="tab" data-tab="studentHomework">Homework</button>
                    <button class="tab" data-tab="studentMessages">Messages</button>
                    <button class="tab" data-tab="subjects">Subjects</button>
                </div>

                <div class="tab-content active" id="profileTab">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Student Details</h3>
                        </div>
                        <div style="display: flex; gap: 20px; align-items: center; margin-bottom: 20px;">
                            <div class="student-img">
                                <img src="" alt="Student Image" id="profileStudentImg">
                            </div>
                            <div>
                                <h3 id="profileStudentName">Student Name</h3>
                                <p id="profileStudentClass">Class</p>
                            </div>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div>
                                <p><strong>Date of Birth:</strong> <span id="profileDob">--</span></p>
                                <p><strong>Admission No:</strong> <span id="profileAdmissionNo">--</span></p>
                            </div>
                            <div>
                                <p><strong>Roll No:</strong> <span id="profileRollNo">--</span></p>
                                <p><strong>School:</strong> <span id="profileSchool">Kendriya Vidyalaya Malkapuram</span></p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tab-content" id="studentHomeworkTab">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Your Homework</h3>
                        </div>
                        <div id="studentHomeworkList">
                            <!-- Student homework items will be dynamically added here -->
                        </div>
                    </div>
                </div>

                <div class="tab-content" id="studentMessagesTab">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Important Messages</h3>
                        </div>
                        <div id="studentMessageList">
                            <!-- Student message items will be dynamically added here -->
                        </div>
                    </div>
                </div>

                <div class="tab-content" id="subjectsTab">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Subject Resources</h3>
                        </div>
                        <div class="subject-selection" id="subjectSelection">
                            <button class="btn btn-secondary back-to-dashboard" id="backToDashboard">
                                <i class="fas fa-arrow-left"></i> Back to Dashboard
                            </button>
                            <h3 style="margin-bottom: 20px;">Select Your Class</h3>
                            <div class="class-selection" id="classSelection">
                                <!-- Class buttons will be dynamically added here -->
                            </div>
                            <div class="subjects-container" id="subjectsContainer">
                                <!-- Subject cards will be dynamically added here -->
                            </div>
                            <div class="subject-content" id="subjectContent">
                                <!-- Subject content will be dynamically added here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="footer">
                <p>Kendriya Vidyalaya Malkapuram &copy; 2023. All rights reserved.</p>
            </div>
        </div>
    </div>

    <script>
        // DOM Elements
        const loginPage = document.getElementById('loginPage');
        const onboarding = document.getElementById('onboarding');
        const portalContainer = document.getElementById('portalContainer');
        
        // Login options
        const teacherLoginOption = document.getElementById('teacherLoginOption');
        const studentLoginOption = document.getElementById('studentLoginOption');
        
        // Onboarding steps
        const step1 = document.getElementById('step1');
        const step2 = document.getElementById('step2');
        const step3 = document.getElementById('step3');
        const step4 = document.getElementById('step4');
        const step5 = document.getElementById('step5');
        
        // Onboarding buttons
        const nextStep1 = document.getElementById('nextStep1');
        const prevStep2 = document.getElementById('prevStep2');
        const nextStep2 = document.getElementById('nextStep2');
        const prevStep3 = document.getElementById('prevStep3');
        const nextStep3 = document.getElementById('nextStep3');
        const prevStep4 = document.getElementById('prevStep4');
        const nextStep4 = document.getElementById('nextStep4');
        const prevStep5 = document.getElementById('prevStep5');
        const completeOnboarding = document.getElementById('completeOnboarding');
        
        // Typing text elements
        const typingText1 = document.getElementById('typingText1');
        const typingText2 = document.getElementById('typingText2');
        const typingText3 = document.getElementById('typingText3');
        const typingText4 = document.getElementById('typingText4');
        const typingText5 = document.getElementById('typingText5');
        
        // Theme selection
        const themeOptions = document.querySelectorAll('.theme-option');
        
        // Portal elements
        const themeToggle = document.getElementById('themeToggle');
        const teacherLogin = document.getElementById('teacherLogin');
        const studentLogin = document.getElementById('studentLogin');
        const backFromTeacherLogin = document.getElementById('backFromTeacherLogin');
        const backFromStudentLogin = document.getElementById('backFromStudentLogin');
        const teacherLoginBtn = document.getElementById('teacherLoginBtn');
        const teacherSection = document.getElementById('teacherSection');
        const teacherSelect = document.getElementById('teacherSelect');
        
        // Face recognition elements
        const cameraVideo = document.getElementById('cameraVideo');
        const cameraCanvas = document.getElementById('cameraCanvas');
        const scanOverlay = document.getElementById('scanOverlay');
        const scanStatus = document.getElementById('scanStatus');
        const startScanBtn = document.getElementById('startScanBtn');
        const captureBtn = document.getElementById('captureBtn');
        
        // Dashboard elements
        const teacherDashboard = document.getElementById('teacherDashboard');
        const studentDashboard = document.getElementById('studentDashboard');
        const teacherLogoutBtn = document.getElementById('teacherLogoutBtn');
        const studentLogoutBtn = document.getElementById('studentLogoutBtn');
        
        // Teacher dashboard elements
        const teacherName = document.getElementById('teacherName');
        const teacherDetails = document.getElementById('teacherDetails');
        const teacherAvatar = document.getElementById('teacherAvatar');
        const studentList = document.getElementById('studentList');
        const addStudentBtn = document.getElementById('addStudentBtn');
        const assignHomeworkBtn = document.getElementById('assignHomeworkBtn');
        const homeworkList = document.getElementById('homeworkList');
        const sendMessageBtn = document.getElementById('sendMessageBtn');
        const messageList = document.getElementById('messageList');
        const studentClass = document.getElementById('studentClass');
        const streamSelection = document.getElementById('streamSelection');
        const studentStream = document.getElementById('studentStream');
        
        // Student dashboard elements
        const studentName = document.getElementById('studentName');
        const studentDetails = document.getElementById('studentDetails');
        const studentAvatar = document.getElementById('studentAvatar');
        const profileStudentImg = document.getElementById('profileStudentImg');
        const profileStudentName = document.getElementById('profileStudentName');
        const profileStudentClass = document.getElementById('profileStudentClass');
        const profileDob = document.getElementById('profileDob');
        const profileAdmissionNo = document.getElementById('profileAdmissionNo');
        const profileRollNo = document.getElementById('profileRollNo');
        const profileSchool = document.getElementById('profileSchool');
        const studentHomeworkList = document.getElementById('studentHomeworkList');
        const studentMessageList = document.getElementById('studentMessageList');
        
        // Subject selection elements
        const subjectSelection = document.getElementById('subjectSelection');
        const classSelection = document.getElementById('classSelection');
        const subjectsContainer = document.getElementById('subjectsContainer');
        const subjectContent = document.getElementById('subjectContent');
        const backToDashboard = document.getElementById('backToDashboard');
        
        // Text content for each step
        const stepTexts = [
            "Welcome to Kendriya Vidyalaya Malkapuram's Educational Portal. We're excited to have you here! This platform will help teachers and students connect, share resources, and enhance the learning experience.",
            "Let's create your profile. Whether you're a teacher or student, you'll have access to personalized features that make teaching and learning more effective and engaging.",
            "KVMLK stands for Kendriya Vidyalaya Malkapuram - our identity and commitment to excellence in education. We follow the CBSE curriculum with a focus on holistic development.",
            "Explore our features: Homework assignment, messaging system, resource sharing, and more. Everything you need for a seamless educational experience is right here.",
            "Choose your preferred theme. You can always change this later from the portal settings. Select the one that suits your visual preference best."
        ];
        
        // Teachers data
        const teachers = {
            primary: [
                { id: 'srinivas', name: 'Srinivas', subject: 'Primary Teacher', password: 'kvmlk' },
                { id: 'srikanth', name: 'Srikanth', subject: 'Primary Teacher', password: 'kvmlk' }
            ],
            secondary: [
                { id: 'narasinga', name: 'Narasinga Rao', subject: 'Chemistry', password: 'kvmlk' },
                { id: 'vara', name: 'Vara Kumar', subject: 'Physics', password: 'kvmlk' }
            ]
        };
        
        // Students data - only students added by teachers can access
        let students = JSON.parse(localStorage.getItem('students')) || [];
        
        // Sample data for homeworks and messages
        let homeworks = JSON.parse(localStorage.getItem('homeworks')) || [];
        let messages = JSON.parse(localStorage.getItem('messages')) || [];
        
        // Current step
        let currentStep = 1;
        
        // Current user
        let currentUser = null;
        let currentUserType = null;
        
        // Camera stream
        let stream = null;
        
        // Subject data
        const subjects = {
            "1-5": [
                { name: "EVS", icon: "fas fa-leaf" },
                { name: "English", icon: "fas fa-language" },
                { name: "Hindi", icon: "fas fa-book" },
                { name: "Maths", icon: "fas fa-calculator" },
                { name: "Computer", icon: "fas fa-laptop" }
            ],
            "6-10": [
                { name: "Science", icon: "fas fa-flask" },
                { name: "English", icon: "fas fa-language" },
                { name: "Maths", icon: "fas fa-calculator" },
                { name: "Hindi", icon: "fas fa-book" },
                { name: "Sanskrit", icon: "fas fa-scroll" },
                { name: "Computer", icon: "fas fa-laptop" },
                { name: "A.I.", icon: "fas fa-robot" }
            ],
            "11A-MPC": [
                { name: "Maths", icon: "fas fa-calculator" },
                { name: "Physics", icon: "fas fa-atom" },
                { name: "Chemistry", icon: "fas fa-flask" },
                { name: "English", icon: "fas fa-language" },
                { name: "Computer Science", icon: "fas fa-laptop-code" },
                { name: "A.I.", icon: "fas fa-robot" }
            ],
            "11A-BIPC": [
                { name: "Biology", icon: "fas fa-dna" },
                { name: "Physics", icon: "fas fa-atom" },
                { name: "Chemistry", icon: "fas fa-flask" },
                { name: "Hindi", icon: "fas fa-book" },
                { name: "English", icon: "fas fa-language" },
                { name: "A.I.", icon: "fas fa-robot" }
            ],
            "11B": [
                { name: "Accountancy", icon: "fas fa-file-invoice-dollar" },
                { name: "Business Studies", icon: "fas fa-chart-line" },
                { name: "Economics", icon: "fas fa-money-bill-wave" },
                { name: "English", icon: "fas fa-language" },
                { name: "Maths", icon: "fas fa-calculator" }
            ],
            "11C": [
                { name: "History", icon: "fas fa-landmark" },
                { name: "Political Science", icon: "fas fa-balance-scale" },
                { name: "English", icon: "fas fa-language" },
                { name: "Geography", icon: "fas fa-globe-asia" },
                { name: "Maths", icon: "fas fa-calculator" }
            ],
            "12A-MPC": [
                { name: "Maths", icon: "fas fa-calculator" },
                { name: "Physics", icon: "fas fa-atom" },
                { name: "Chemistry", icon: "fas fa-flask" },
                { name: "English", icon: "fas fa-language" },
                { name: "Computer Science", icon: "fas fa-laptop-code" },
                { name: "A.I.", icon: "fas fa-robot" }
            ],
            "12A-BIPC": [
                { name: "Biology", icon: "fas fa-dna" },
                { name: "Physics", icon: "fas fa-atom" },
                { name: "Chemistry", icon: "fas fa-flask" },
                { name: "Hindi", icon: "fas fa-book" },
                { name: "English", icon: "fas fa-language" },
                { name: "A.I.", icon: "fas fa-robot" }
            ],
            "12B": [
                { name: "Accountancy", icon: "fas fa-file-invoice-dollar" },
                { name: "Business Studies", icon: "fas fa-chart-line" },
                { name: "Economics", icon: "fas fa-money-bill-wave" },
                { name: "English", icon: "fas fa-language" },
                { name: "Maths", icon: "fas fa-calculator" }
            ],
            "12C": [
                { name: "History", icon: "fas fa-landmark" },
                { name: "Political Science", icon: "fas fa-balance-scale" },
                { name: "English", icon: "fas fa-language" },
                { name: "Geography", icon: "fas fa-globe-asia" },
                { name: "Maths", icon: "fas fa-calculator" }
            ]
        };
        
        // Typing animation function
        function typeText(element, text, speed = 30) {
            return new Promise(resolve => {
                element.innerHTML = '';
                let i = 0;
                
                function typeChar() {
                    if (i < text.length) {
                        element.innerHTML += text.charAt(i);
                        i++;
                        setTimeout(typeChar, speed);
                    } else {
                        // Add blinking cursor at the end
                        const cursor = document.createElement('span');
                        cursor.className = 'typing-cursor';
                        element.appendChild(cursor);
                        resolve();
                    }
                }
                
                typeChar();
            });
        }
        
        // Update progress indicators
        function updateProgressIndicators() {
            const dots = document.querySelectorAll('.progress-dot');
            dots.forEach((dot, index) => {
                if (index + 1 === currentStep) {
                    dot.classList.add('active');
                } else {
                    dot.classList.remove('active');
                }
            });
        }
        
        // Show step function
        function showStep(stepNumber) {
            // Hide all steps
            document.querySelectorAll('.onboarding-step').forEach(step => {
                step.classList.remove('active');
            });
            
            // Show the current step
            document.getElementById(`step${stepNumber}`).classList.add('active');
            
            // Update current step
            currentStep = stepNumber;
            
            // Update progress indicators
            updateProgressIndicators();
            
            // Type the text for this step
            const textElement = document.getElementById(`typingText${stepNumber}`);
            typeText(textElement, stepTexts[stepNumber - 1]);
        }
        
        // Start onboarding after login
        function startOnboarding() {
            loginPage.style.display = 'none';
            onboarding.style.display = 'flex';
            showStep(1);
        }
        
        // Theme selection
        themeOptions.forEach(option => {
            option.addEventListener('click', () => {
                // Remove selected class from all options
                themeOptions.forEach(opt => opt.classList.remove('selected'));
                
                // Add selected class to clicked option
                option.classList.add('selected');
                
                // Apply the selected theme
                const selectedTheme = option.getAttribute('data-theme');
                document.body.setAttribute('data-theme', selectedTheme);
                
                // Update theme toggle button
                if (selectedTheme === 'dark') {
                    themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
                } else {
                    themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
                }
                
                // Save theme preference
                localStorage.setItem('theme', selectedTheme);
            });
        });
        
        // Theme toggle in portal
        themeToggle.addEventListener('click', () => {
            const isDark = document.body.getAttribute('data-theme') === 'dark';
            if (isDark) {
                document.body.removeAttribute('data-theme');
                themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
                localStorage.setItem('theme', 'light');
            } else {
                document.body.setAttribute('data-theme', 'dark');
                themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
                localStorage.setItem('theme', 'dark');
            }
        });
        
        // Onboarding navigation
        nextStep1.addEventListener('click', () => {
            showStep(2);
        });
        
        prevStep2.addEventListener('click', () => {
            showStep(1);
        });
        
        nextStep2.addEventListener('click', () => {
            showStep(3);
        });
        
        prevStep3.addEventListener('click', () => {
            showStep(2);
        });
        
        nextStep3.addEventListener('click', () => {
            showStep(4);
        });
        
        prevStep4.addEventListener('click', () => {
            showStep(3);
        });
        
        nextStep4.addEventListener('click', () => {
            showStep(5);
        });
        
        prevStep5.addEventListener('click', () => {
            showStep(4);
        });
        
        completeOnboarding.addEventListener('click', () => {
            // Mark onboarding as completed
            localStorage.setItem('hasCompletedOnboarding', 'true');
            
            // Hide onboarding and show portal
            onboarding.style.display = 'none';
            portalContainer.classList.add('active');
        });
        
        // Login options
        teacherLoginOption.addEventListener('click', () => {
            startOnboarding();
        });
        
        studentLoginOption.addEventListener('click', () => {
            startOnboarding();
        });
        
        // Populate teacher dropdown based on section
        function populateTeacherDropdown() {
            teacherSelect.innerHTML = '<option value="">-- Select Teacher --</option>';
            const section = teacherSection.value;
            
            if (section && teachers[section]) {
                teachers[section].forEach(teacher => {
                    const option = document.createElement('option');
                    option.value = teacher.id;
                    option.textContent = `${teacher.name} (${teacher.subject})`;
                    teacherSelect.appendChild(option);
                });
            }
        }
        
        // Teacher login
        teacherLoginBtn.addEventListener('click', () => {
            const password = document.getElementById('teacherPassword').value;
            const selectedTeacherId = teacherSelect.value;
            const section = teacherSection.value;
            
            if (!section) {
                alert('Please select a section first.');
                return;
            }
            
            const teacher = teachers[section].find(t => t.id === selectedTeacherId);
            
            if (password === teacher.password && selectedTeacherId) {
                // Set current user
                currentUser = teacher;
                currentUserType = 'teacher';
                
                // Update teacher dashboard
                teacherName.textContent = teacher.name;
                teacherDetails.textContent = `Kendriya Vidyalaya Malkapuram | ${teacher.subject}`;
                teacherAvatar.src = "https://blogger.googleusercontent.com/img/a/AVvXsEiJY7J3N211LgvtEmXBQYBTrhyV4Msf-rXEkPr6Ns-BxAbOp-2rLh-V4MhUOj9pL0lhHjPbIbdYm7IxB3_wXggfa6hLq8iYu0e3NC9NThaTn61zBVjbFUgF3VPlYmS9BxqmolSzAQW1DYmUea5EiquLqysBntxklO7OQ6uBeZvCLLEkjaKnGaW7FMPakj0";
                
                // Hide login and show dashboard
                teacherLogin.classList.remove('active');
                teacherDashboard.classList.add('active');
                
                // Render students
                renderStudents();
                renderHomeworks();
                renderMessages();
            } else {
                alert('Please select a teacher and enter correct password.');
            }
        });
        
        // Face recognition for student login
        startScanBtn.addEventListener('click', async () => {
            try {
                stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { width: 300, height: 300 } 
                });
                cameraVideo.srcObject = stream;
                scanOverlay.style.display = 'none';
                scanStatus.textContent = 'Position your face in the frame';
                startScanBtn.style.display = 'none';
                captureBtn.style.display = 'inline-block';
            } catch (err) {
                console.error("Error accessing camera: ", err);
                scanOverlay.querySelector('p').textContent = 'Camera access denied';
                scanStatus.textContent = 'Camera access is required for face verification';
            }
        });
        
        captureBtn.addEventListener('click', () => {
            // Capture image from camera
            const context = cameraCanvas.getContext('2d');
            context.drawImage(cameraVideo, 0, 0, cameraCanvas.width, cameraCanvas.height);
            const imageData = cameraCanvas.toDataURL('image/png');
            
            // Stop camera
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
                stream = null;
            }
            
            // Verify face against stored students
            const verifiedStudent = verifyFace(imageData);
            
            if (verifiedStudent) {
                scanStatus.textContent = 'Face verified successfully!';
                
                // Set current user
                currentUser = verifiedStudent;
                currentUserType = 'student';
                
                // Update student dashboard
                studentName.textContent = verifiedStudent.name;
                studentDetails.textContent = `Class ${verifiedStudent.class} | Roll No: ${verifiedStudent.rollNo}`;
                
                profileStudentName.textContent = verifiedStudent.name;
                profileStudentClass.textContent = `Class ${verifiedStudent.class}`;
                profileDob.textContent = formatDate(verifiedStudent.dob);
                profileAdmissionNo.textContent = verifiedStudent.admissionNo;
                profileRollNo.textContent = verifiedStudent.rollNo;
                profileSchool.textContent = "Kendriya Vidyalaya Malkapuram";
                
                if (verifiedStudent.image) {
                    studentAvatar.src = verifiedStudent.image;
                    profileStudentImg.src = verifiedStudent.image;
                }
                
                // Hide login and show dashboard after delay
                setTimeout(() => {
                    studentLogin.classList.remove('active');
                    studentDashboard.classList.add('active');
                    
                    // Render student data
                    renderStudentHomework();
                    renderStudentMessages();
                    renderClassSelection();
                }, 1500);
            } else {
                scanStatus.textContent = 'Face verification failed. You are not registered in our system.';
                captureBtn.style.display = 'none';
                startScanBtn.style.display = 'inline-block';
            }
        });
        
        // Simple face verification (in real app, this would use proper face recognition API)
        function verifyFace(capturedImage) {
            // Check if any student's face matches (simplified for demo)
            // In a real application, this would compare facial features
            if (students.length === 0) {
                return null;
            }
            
            // For demo purposes, we'll just return the first student
            // In a real app, this would use proper face recognition
            return students[0];
        }
        
        // Teacher dashboard functions
        function renderStudents() {
            studentList.innerHTML = '';
            if (students.length === 0) {
                studentList.innerHTML = '<p>No students added yet. Add students using the form above.</p>';
                return;
            }
            
            students.forEach(student => {
                const studentCard = document.createElement('div');
                studentCard.className = 'student-card';
                studentCard.innerHTML = `
                    <div class="student-img">
                        ${student.image ? `<img src="${student.image}" alt="${student.name}">` : `<i class="fas fa-user"></i>`}
                    </div>
                    <h4>${student.name}</h4>
                    <p>Class: ${student.class}</p>
                    <p>Roll No: ${student.rollNo}</p>
                `;
                studentList.appendChild(studentCard);
            });
        }
        
        function renderHomeworks() {
            homeworkList.innerHTML = '';
            if (homeworks.length === 0) {
                homeworkList.innerHTML = '<p>No homework assigned yet.</p>';
                return;
            }
            
            homeworks.forEach(homework => {
                const homeworkItem = document.createElement('div');
                homeworkItem.className = 'homework-item';
                homeworkItem.innerHTML = `
                    <h4>${homework.title}</h4>
                    <p>${homework.description}</p>
                    <div class="homework-meta">
                        <span>Due: ${formatDate(homework.dueDate)}</span>
                        <span>Assigned: ${formatDate(homework.assignedDate)}</span>
                    </div>
                `;
                homeworkList.appendChild(homeworkItem);
            });
        }
        
        function renderMessages() {
            messageList.innerHTML = '';
            if (messages.length === 0) {
                messageList.innerHTML = '<p>No messages sent yet.</p>';
                return;
            }
            
            messages.forEach(message => {
                const messageItem = document.createElement('div');
                messageItem.className = 'message-item';
                messageItem.innerHTML = `
                    <h4>${message.title}</h4>
                    <p>${message.content}</p>
                    <div class="message-meta">
                        <span>${formatDate(message.date)}</span>
                    </div>
                `;
                messageList.appendChild(messageItem);
            });
        }
        
        // Add student function
        addStudentBtn.addEventListener('click', () => {
            const imageFile = document.getElementById('studentImage').files[0];
            const name = document.getElementById('studentName').value;
            const classVal = document.getElementById('studentClass').value;
            const streamVal = document.getElementById('studentStream').value;
            const dob = document.getElementById('studentDob').value;
            const admissionNo = document.getElementById('studentAdmissionNo').value;
            const rollNo = document.getElementById('studentRollNo').value;
            
            if (!imageFile) {
                alert('Please upload a student image for face recognition.');
                return;
            }
            
            if (!name || !classVal || !dob || !admissionNo || !rollNo) {
                alert('Please fill all fields.');
                return;
            }
            
            // Convert image to base64 for storage
            const reader = new FileReader();
            reader.onload = function(e) {
                const newStudent = {
                    id: students.length > 0 ? Math.max(...students.map(s => s.id)) + 1 : 1,
                    name,
                    class: classVal,
                    stream: streamVal,
                    dob,
                    admissionNo,
                    rollNo: parseInt(rollNo),
                    image: e.target.result
                };
                
                students.push(newStudent);
                localStorage.setItem('students', JSON.stringify(students));
                renderStudents();
                
                // Clear form
                document.getElementById('studentImage').value = '';
                document.getElementById('studentName').value = '';
                document.getElementById('studentClass').value = '';
                document.getElementById('studentStream').value = '';
                document.getElementById('studentDob').value = '';
                document.getElementById('studentAdmissionNo').value = '';
                document.getElementById('studentRollNo').value = '';
                
                alert('Student added successfully! This student can now access the student portal with face recognition.');
            };
            reader.readAsDataURL(imageFile);
        });
        
        // Student dashboard functions
        function renderStudentHomework() {
            studentHomeworkList.innerHTML = '';
            if (homeworks.length === 0) {
                studentHomeworkList.innerHTML = '<p>No homework assigned yet.</p>';
                return;
            }
            
            homeworks.forEach(homework => {
                const homeworkItem = document.createElement('div');
                homeworkItem.className = 'homework-item';
                homeworkItem.innerHTML = `
                    <h4>${homework.title}</h4>
                    <p>${homework.description}</p>
                    <div class="homework-meta">
                        <span>Due: ${formatDate(homework.dueDate)}</span>
                        <span>Assigned: ${formatDate(homework.assignedDate)}</span>
                    </div>
                `;
                studentHomeworkList.appendChild(homeworkItem);
            });
        }
        
        function renderStudentMessages() {
            studentMessageList.innerHTML = '';
            if (messages.length === 0) {
                studentMessageList.innerHTML = '<p>No messages yet.</p>';
                return;
            }
            
            messages.forEach(message => {
                const messageItem = document.createElement('div');
                messageItem.className = 'message-item';
                messageItem.innerHTML = `
                    <h4>${message.title}</h4>
                    <p>${message.content}</p>
                    <div class="message-meta">
                        <span>${formatDate(message.date)}</span>
                    </div>
                `;
                studentMessageList.appendChild(messageItem);
            });
        }
        
        // Render class selection for subjects
        function renderClassSelection() {
            classSelection.innerHTML = '';
            
            const classes = [
                { name: "Class 1-5", value: "1-5" },
                { name: "Class 6-10", value: "6-10" },
                { name: "Class 11A", value: "11A" },
                { name: "Class 11B", value: "11B" },
                { name: "Class 11C", value: "11C" },
                { name: "Class 12A", value: "12A" },
                { name: "Class 12B", value: "12B" },
                { name: "Class 12C", value: "12C" }
            ];
            
            classes.forEach(classItem => {
                const classBtn = document.createElement('button');
                classBtn.className = 'class-btn';
                classBtn.textContent = classItem.name;
                classBtn.setAttribute('data-class', classItem.value);
                classBtn.addEventListener('click', () => {
                    document.querySelectorAll('.class-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    classBtn.classList.add('active');
                    renderSubjects(classItem.value);
                });
                classSelection.appendChild(classBtn);
            });
        }
        
        // Render subjects based on selected class
        function renderSubjects(classValue) {
            subjectsContainer.innerHTML = '';
            subjectContent.classList.remove('active');
            
            let subjectList = [];
            
            if (classValue === "1-5") {
                subjectList = subjects["1-5"];
            } else if (classValue === "6-10") {
                subjectList = subjects["6-10"];
            } else if (classValue === "11A") {
                // Show stream selection for 11A
                const streamSelectionDiv = document.createElement('div');
                streamSelectionDiv.innerHTML = `
                    <h3 style="margin-bottom: 15px;">Select Your Stream</h3>
                    <div style="display: flex; gap: 15px; margin-bottom: 20px;">
                        <button class="btn" id="mpcBtn">MPC</button>
                        <button class="btn" id="bipcBtn">BIPC</button>
                    </div>
                `;
                subjectsContainer.appendChild(streamSelectionDiv);
                
                document.getElementById('mpcBtn').addEventListener('click', () => {
                    renderSubjectCards(subjects["11A-MPC"]);
                });
                
                document.getElementById('bipcBtn').addEventListener('click', () => {
                    renderSubjectCards(subjects["11A-BIPC"]);
                });
                
                return;
            } else if (classValue === "11B") {
                subjectList = subjects["11B"];
            } else if (classValue === "11C") {
                subjectList = subjects["11C"];
            } else if (classValue === "12A") {
                // Show stream selection for 12A
                const streamSelectionDiv = document.createElement('div');
                streamSelectionDiv.innerHTML = `
                    <h3 style="margin-bottom: 15px;">Select Your Stream</h3>
                    <div style="display: flex; gap: 15px; margin-bottom: 20px;">
                        <button class="btn" id="mpcBtn12">MPC</button>
                        <button class="btn" id="bipcBtn12">BIPC</button>
                    </div>
                `;
                subjectsContainer.appendChild(streamSelectionDiv);
                
                document.getElementById('mpcBtn12').addEventListener('click', () => {
                    renderSubjectCards(subjects["12A-MPC"]);
                });
                
                document.getElementById('bipcBtn12').addEventListener('click', () => {
                    renderSubjectCards(subjects["12A-BIPC"]);
                });
                
                return;
            } else if (classValue === "12B") {
                subjectList = subjects["12B"];
            } else if (classValue === "12C") {
                subjectList = subjects["12C"];
            }
            
            renderSubjectCards(subjectList);
        }
        
        // Render subject cards
        function renderSubjectCards(subjectList) {
            subjectsContainer.innerHTML = '';
            
            subjectList.forEach(subject => {
                const subjectCard = document.createElement('div');
                subjectCard.className = 'subject-card';
                subjectCard.innerHTML = `
                    <div class="subject-icon">
                        <i class="${subject.icon}"></i>
                    </div>
                    <h3>${subject.name}</h3>
                `;
                subjectCard.addEventListener('click', () => {
                    showSubjectContent(subject.name);
                });
                subjectsContainer.appendChild(subjectCard);
            });
        }
        
        // Show subject content
        function showSubjectContent(subjectName) {
            subjectsContainer.style.display = 'none';
            subjectContent.classList.add('active');
            subjectContent.innerHTML = `
                <h3 style="margin-bottom: 20px;">${subjectName}</h3>
                <button class="btn ncert-btn btn-block" style="margin-bottom: 10px;">
                    <i class="fas fa-book"></i> NCERT
                </button>
                <button class="btn solution-btn btn-block">
                    <i class="fas fa-check-circle"></i> Solution
                </button>
            `;
            
            // Add event listeners for NCERT and Solution buttons
            document.querySelector('.ncert-btn').addEventListener('click', () => {
                alert(`NCERT content for ${subjectName} would be displayed here.`);
            });
            
            document.querySelector('.solution-btn').addEventListener('click', () => {
                alert(`Solution content for ${subjectName} would be displayed here.`);
            });
        }
        
        // Back to dashboard from subject content
        backToDashboard.addEventListener('click', () => {
            subjectContent.classList.remove('active');
            subjectsContainer.style.display = 'grid';
        });
        
        // Assign homework
        assignHomeworkBtn.addEventListener('click', () => {
            const title = document.getElementById('homeworkTitle').value;
            const description = document.getElementById('homeworkDescription').value;
            const dueDate = document.getElementById('homeworkDueDate').value;
            
            if (!title || !description || !dueDate) {
                alert('Please fill all fields.');
                return;
            }
            
            const newHomework = {
                id: homeworks.length + 1,
                title,
                description,
                dueDate,
                assignedDate: new Date().toISOString().split('T')[0]
            };
            
            homeworks.unshift(newHomework);
            localStorage.setItem('homeworks', JSON.stringify(homeworks));
            renderHomeworks();
            
            // Clear form
            document.getElementById('homeworkTitle').value = '';
            document.getElementById('homeworkDescription').value = '';
            document.getElementById('homeworkDueDate').value = '';
            
            alert('Homework assigned successfully!');
        });
        
        // Send message
        sendMessageBtn.addEventListener('click', () => {
            const title = document.getElementById('messageTitle').value;
            const content = document.getElementById('messageContent').value;
            
            if (!title || !content) {
                alert('Please fill all fields.');
                return;
            }
            
            const newMessage = {
                id: messages.length + 1,
                title,
                content,
                date: new Date().toISOString().split('T')[0]
            };
            
            messages.unshift(newMessage);
            localStorage.setItem('messages', JSON.stringify(messages));
            renderMessages();
            
            // Clear form
            document.getElementById('messageTitle').value = '';
            document.getElementById('messageContent').value = '';
            
            alert('Message sent successfully!');
        });
        
        // Tab functionality
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                const tabId = tab.getAttribute('data-tab');
                
                // Update active tab
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                
                // Show active tab content
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                    if (content.id === `${tabId}Tab`) {
                        content.classList.add('active');
                    }
                });
            });
        });
        
        // Navigation back buttons
        backFromTeacherLogin.addEventListener('click', () => {
            teacherLogin.classList.remove('active');
        });
        
        backFromStudentLogin.addEventListener('click', () => {
            studentLogin.classList.remove('active');
        });
        
        teacherSection.addEventListener('change', populateTeacherDropdown);
        
        // Show/hide stream selection based on class
        studentClass.addEventListener('change', () => {
            if (studentClass.value === '11A') {
                streamSelection.style.display = 'block';
            } else {
                streamSelection.style.display = 'none';
            }
        });
        
        // Logout functionality
        teacherLogoutBtn.addEventListener('click', () => {
            teacherDashboard.classList.remove('active');
            document.getElementById('teacherPassword').value = '';
            currentUser = null;
            currentUserType = null;
            
            // Return to login page
            portalContainer.classList.remove('active');
            loginPage.style.display = 'flex';
        });
        
        studentLogoutBtn.addEventListener('click', () => {
            studentDashboard.classList.remove('active');
            currentUser = null;
            currentUserType = null;
            
            // Return to login page
            portalContainer.classList.remove('active');
            loginPage.style.display = 'flex';
        });
        
        // Helper function to format date
        function formatDate(dateString) {
            const options = { year: 'numeric', month: 'short', day: 'numeric' };
            return new Date(dateString).toLocaleDateString('en-US', options);
        }
        
        // Initialize the application
        window.addEventListener('load', () => {
            // Apply saved theme if exists
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.body.setAttribute('data-theme', 'dark');
                themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
            }
            
            // Check if user has completed onboarding before
            const hasCompletedOnboarding = localStorage.getItem('hasCompletedOnboarding');
            
            if (hasCompletedOnboarding) {
                // Skip onboarding if already completed
                loginPage.style.display = 'flex';
            } else {
                // Show login page by default
                loginPage.style.display = 'flex';
            }
        });
    </script>
</body>
</html>
